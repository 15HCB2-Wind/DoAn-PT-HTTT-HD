@{
    ViewBag.Title = "Update";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@section Scripts{
    <script>
        var listchuong;
        $(document).ready(function () {
                window.params = function () {
                    var params = {};
                    var param_array = window.location.href.split('?')[1].split('&');
                    for (var i in param_array) {
                        x = param_array[i].split('=');
                        params[x[0]] = x[1];
                    }
                    return params;
                }();
                var temp = document.getElementById('maphancong');
                temp.innerHTML = "Phân Công: " + window.params.maphancong;
                var tennv = document.getElementById('tennv');
                tennv.innerHTML = params.hoten;
                callAjax('post', { Data: { maphancong: "'" + window.params.maphancong + "'" } }, "hcm", "animal_care", "assignment/getSingleAssignment", function (data) {
                    console.log(data);
                    var ngaybatdau = document.getElementById('ngaybatdau');
                    ngaybatdau.value = data.Data.NgayBatDauFormatted;
                    var ngayketthuc = document.getElementById('ngayketthuc');
                    ngayketthuc.value = data.Data.NgayKetThucFormatted;
                    var btnCT = document.getElementById('btnCT');
                    btnCT.innerHTML = data.Data.TenChuong;

                    callAjax('post', { MaCN: "CN0001" }, "hcm", "management", "ChuongTrai/getAll", function (data2) {
                        console.log(data2);
                        listchuong = data2.Data;
                        for (var i = 0; i < data2.Data.length; i++) {
                            $("#dropdown").append('<a class="dropdown-item" onclick="chuongtraiclick('+ i +')">' + data2.Data[i].tenchuong + '</a>');
                        }
                        for (var i = 0; i < data2.Data.length; i++) {
                            if (data.Data.MaChuong == data2.Data[i].machuong) {
                                btnCT.innerHTML = data2.Data[i].tenchuong;
                            }
                        }
                    });
                });
                
            });
            

        $('.datepicker').pickadate({
            monthsFull: ['Tháng 1', 'Tháng 2', 'Tháng 3', 'Tháng 4', 'Tháng 5', 'Tháng 6', 'Tháng 7', 'Tháng 8', 'Tháng 9', 'Tháng 10', 'Tháng 11', 'Tháng 12'],
            monthsShort: ['Tháng 1', 'Tháng 2', 'Tháng 3', 'Tháng 4', 'Tháng 5', 'Tháng 6', 'Tháng 7', 'Tháng 8', 'Tháng 9', 'Tháng 10', 'Tháng 11', 'Tháng 12'],
            weekdaysFull: ['Chủ nhật', 'Thứ 2', 'Thứ 3', 'Thứ 4', 'Thứ 5', 'Thứ 6', 'Thứ 7'],
            weekdaysShort: ['CN', 'T2', 'T3', 'T4', 'T5', 'T6', 'T7'],

            showMonthsShort: true,
            showWeekdaysFull: false,

            today: 'Hôm nay',
            clear: '',
            close: 'Đóng',

            labelMonthNext: 'Tháng sau',
            labelMonthPrev: 'Tháng trước',
            labelMonthSelect: 'Chọn tháng',
            labelYearSelect: 'Chọn năm',

            firstDay: 1,
            format: 'dd-mm-yyyy',
            formatSubmit: 'yyyy-mm-dd',

            min: new Date(1752, 0, 1),
            max: new Date(9998, 11, 31)
        });

        function saveclick() {
            var data = {
            MaPhanCong :
    NgayBatDau :
NgayKetThuc :
    NgayTrongTuan :
    MaNV :
    MaChuong: 
            };
            callAjax('post', { MaCN: "CN0001" }, "hcm", "management", "ChuongTrai/getAll", function (data2) {
                console.log(data2);
            });
        }

        function chuongtraiclick(data) {
            var btnCT = document.getElementById('btnCT');
            btnCT.innerHTML = listchuong[data].tenchuong;
        };
    </script>
    
}

<h2 id="maphancong"></h2>

<div id="controller">

</div>
<form>
    <div id="list_provider">
        <div class="panel-body">

            <div id="button_function">

            </div>

            <div class="dataTable_wrapper">
                <table class="table table-striped table-bordered table-hover" id="dataTables">
                    <thead>
                        <tr>
                            <td class="font-weight-bold">Thuộc tính</td>
                            <td class="font-weight-bold">Giá trị</td>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Tên nhân viên</td>
                            <td id="tennv"></td>
                        </tr>
                        <tr>
                            <td>Ngày trong tuần</td>
                            <td>
                                <div class="form-inline">
                                    <div class="form-group">
                                        <input type="checkbox" id="checkbox2">
                                        <label for="checkbox2">2</label>
                                    </div>
                                    <div class="form-group">
                                        <input type="checkbox" id="checkbox3">
                                        <label for="checkbox3">3</label>
                                    </div>
                                    <div class="form-group">
                                        <input type="checkbox" id="checkbox4">
                                        <label for="checkbox4">4</label>
                                    </div>
                                    <div class="form-group">
                                        <input type="checkbox" id="checkbox5">
                                        <label for="checkbox5">5</label>
                                    </div>
                                    <div class="form-group">
                                        <input type="checkbox" id="checkbox6">
                                        <label for="checkbox6">6</label>
                                    </div>
                                    <div class="form-group">
                                        <input type="checkbox" id="checkbox7">
                                        <label for="checkbox7">7</label>
                                    </div>
                                    <div class="form-group">
                                        <input type="checkbox" id="checkboxCN">
                                        <label for="checkboxCN">CN</label>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>Ngày bắt đầu</td>
                            <td>
                                <div class="md-form form-sm">
                                    <i class="fa fa-calendar prefix"></i>
                                    <input type="text" id="ngaybatdau" class="form-control datepicker" data-value="@(DateTime.Now.ToShortDateString())">
                                    <label for="ngaybatdau"></label>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>Ngày kết thúc</td>
                            <td>
                                <div class="md-form form-sm">
                                    <i class="fa fa-calendar prefix"></i>
                                    <input type="text" id="ngayketthuc" class="form-control datepicker" data-value="@(DateTime.Now.ToShortDateString())">
                                    <label for="ngaykethuc"></label>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>Mã chuồng</td>
                            <td>
                                <div class="btn-group">
                                    <button id="btnCT" class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Chuồng trại</button>
                                    <div class="dropdown-menu" id="dropdown">
                                        <!--load data danh sach chuong-->
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>
                                <button type="button" class="btn btn-success" onclick="saveclick()">Lưu</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</form>


