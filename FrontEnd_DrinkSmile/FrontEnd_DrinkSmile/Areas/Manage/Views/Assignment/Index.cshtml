@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@section Scripts {
    <script>
    $(document).ready(function () {
        callAjax('post', { MaCN: "CN0001", MaPQ: "PQ0001" }, "hcm", "management", "NhanVien/getAllOfAgency", function (data1) {
            console.log(data1);
            callAjax('post', data1, "hcm", "animal_care", "assignment/getListAssignmentsOfAgency", function (data) {
                console.log(data);
                for (var i = 0; i < data.Data.length; i++) {

                    var days = data.Data[i].NgayTrongTuan.split(',');
                    var week = ["2", "3", "4", "5", "6", "7", "CN"];

                    for (var j = 0; j < week.length; j++) {
                        if (!days.includes(week[j])) {
                            week[j] = "";
                        }
                    }

                    var td = "";
                    for (var j = 0; j < week.length; j++) {
                        if (!days.includes(week[j])) {
                            td += '<td></td>';
                        }
                        else {
                            td += '<td><input type="checkbox" id="checkbox3" disabled checked="checked"><label for="checkbox3" class="disabled"></label></td>';
                        }
                    }
                    $('#dataTables').append('<tr height="50px">' +
                        "<td>" + data.Data[i].HoTen + "</td>" +
                        td +
                        "<td>" + data.Data[i].NgayBatDauFormatted + "</td>" +
                        "<td>" + data.Data[i].NgayKetThucFormatted + "</td>" +
                        '<td align="center" valign="middle"><a href="/Manage/Assignment/Update?maphancong=' + data.Data[i].MaPhanCong + '&hoten='+data.Data[i].HoTen+'"><img src="../../../Content/Edit-26.png"/></a></td>' +
                            //'<td align="center" valign="middle"><span class="spnSelected"><img src="../../../Content/Edit-26.png"/></span></td>' +
                            '<td align="center" valign="middle"><span class="spnSelected"><img src="../../../Content/Delete Filled-26.png" alt="Alternate Text"/></span></td>' +
                            "</tr>");
                }
            })
            })
            
        });

        $("#dataTables").on('click', '.spnSelected', function () {
            var self = $(this).closest("tr");
            var col1_value = self.find(".idphancong").text();
            maphancong = col1_value;
            //location.href = "Update?getobj=" + col1_value;
        });
        $(".filled-in").on('mousedown', function () {
            var self = $(this).closest("tr");
            var col1_value = self.find(".idphancong").text();
            alert("Mã phân công:" + col1_value);
        });

        function addclick() {
            window.location.href = 'http://localhost:8082/Manage/Assignment/Create'
        }
    </script>
}

<h2>Quản lý Phân Công</h2>
<div id="controller">

</div>
<form>
    <button type="button" class="btn btn-success" onclick="addclick()">Thêm mới phân công</button>
    <div id="list_provider">
        <div class="panel-body">
            <div class="dataTable_wrapper">
                <table class="table table-striped table-bordered table-hover" id="dataTables">
                    <thead>
                        <tr>
                            <th rowspan="2">Nhân viên</th>
                            <th colspan="7">Ngày trong tuần</th>
                            <th rowspan="2">Bắt đầu</th>
                            <th rowspan="2">Kết thúc</th>
                            <th rowspan="2"></th>
                            <th rowspan="2"></th>
                        </tr>
                        <tr>
                            <td width="60px" align="center" valign="middle">2</td>
                            <td width="60px" align="center" valign="middle">3</td>
                            <td width="60px" align="center" valign="middle">4</td>
                            <td width="60px" align="center" valign="middle">5</td>
                            <td width="60px" align="center" valign="middle">6</td>
                            <td width="60px" align="center" valign="middle">7</td>
                            <td width="60px" align="center" valign="middle">CN</td>
                        </tr>
                    </thead>
                    <tbody>
                        <!---->
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</form>